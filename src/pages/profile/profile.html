<ion-header>
  <page-header [title]="'Profile'"></page-header>
</ion-header>

<ion-content text-center>

  <div class="header-image" style="background-image: url('assets/img/field.jpg');"></div>

  <ion-row justify-content-center>
    <ion-col align-self-center col-auto no-padding>
      <!-- <img class="circular"
           [src]="serverUrl+user.profiles?.profileUrl?.url"
           onError="this.src='assets/img/default-avatar.png'"
           (click)="presentActionSheet('camera')"> -->

      <div class="img-wrapper" (click)="presentActionSheet('camera')">
        <!-- <img class="img-responsive" src="assets/imgs/profile.jpg"> -->
        <div>
          <img class="circular"
               [src]="serverUrl+user.profiles?.profileUrl?.url"
               onError="this.src='assets/img/default-avatar.png'">
        </div>
        <div class="button-div-container">
          <ion-icon color="white" name="create"></ion-icon>
        </div>
      </div>

    </ion-col>
  </ion-row>

  <ion-row>
    <ion-col>
      <p text-capitalize style="margin: 0px; font-size: 2rem;">
        {{user?.profiles?.name || user?.name}}
      </p>
      <i text-center style="opacity: 0.8; margin: 0px; font-size: 10px">Member since {{user.createdAt|moment:true}}</i>
    </ion-col>
  </ion-row>

  <ion-toolbar no-border-top style="padding: 0px; min-height: 0px;">
    <ion-segment [(ngModel)]="farm">
      <ion-segment-button value="accountDetails">
        {{'Account Details'|translate}}
      </ion-segment-button>
      <ion-segment-button value="farmDetails">
        {{'Farm Details'|translate}}
      </ion-segment-button>
      <ion-segment-button value="documents">
        {{'Documents'|translate}}
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>

  <div [ngSwitch]="farm">

    <ion-list *ngSwitchCase="'accountDetails'">

      <ion-list>
        <ion-item>
          <ion-label floating text-capitalize>{{'Agri Id'|translate}}</ion-label>
          <ion-input type="text" [(ngModel)]="user.id" disabled></ion-input>
        </ion-item>
        <ion-item>
          <ion-label floating text-capitalize>{{'Full Name'|translate}}</ion-label>
          <ion-input type="text" (keyup)="onChange($event)" [(ngModel)]="user.profiles.name"></ion-input>
        </ion-item>

        <ion-item>
          <ion-label floating text-capitalize>{{'Mobile Number'|translate}}</ion-label>
          <ion-input type="tel" (keyup)="onChange($event)" [(ngModel)]="user.profiles.phone"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label floating text-capitalize>{{'Wechat ID'|translate}}</ion-label>
          <ion-input type="text" (keyup)="onChange($event)" [(ngModel)]="user.profiles.weChat"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label floating text-capitalize>{{'Company name'|translate}}</ion-label>
          <ion-input [(ngModel)]="user.profiles.company" (keyup)="onChange($event)" type="text"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label floating style="display: inline-table;">{{'Address Line 1 (Street address, P.O. box,
            c\o)'|translate}}
          </ion-label>
          <ion-input type="text" (keyup)="onChange($event)" [(ngModel)]="user.profiles.address.line1"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label floating style="display: inline-table;">{{'Address Line 2 (Unit, building, floor,
            etc.)'|translate}}
          </ion-label>
          <ion-input type="text" (keyup)="onChange($event)" [(ngModel)]="user.profiles.address.line2"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label floating text-capitalize>{{'City'|translate}}</ion-label>
          <ion-input type="text" (keyup)="onChange($event)" [(ngModel)]="user.profiles.address.city"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label floating text-capitalize>{{'State/Province/Region'|translate}}</ion-label>
          <ion-input type="text" (keyup)="onChange($event)" [(ngModel)]="user.profiles.address.province"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label floating text-capitalize>{{'Registration number'|translate}}</ion-label>
          <ion-input type="number" (keyup)="onChange($event)" [(ngModel)]="user.profiles.registration"></ion-input>
        </ion-item>
      </ion-list>
      <!-- (keyup)="onChange($event)" -->
      <ion-row>
        <ion-col>
          <!-- [disabled]="disabledButton" -->
          <button (click)="updateProfile()" [disabled]="disabledButton" ion-button block class="btnHeight40Px">
            {{'Save'|translate}}
          </button>
        </ion-col>
      </ion-row>

    </ion-list>

    <ion-list *ngSwitchCase="'farmDetails'">

      <ion-list>
        <ion-item>

          <ion-label floating text-capitalize>{{'Farm Name'|translate}}</ion-label>
          <ion-input type="text" (keyup)="onFarmChange($event)"
                     [(ngModel)]="user.profiles.farmDetails.farmName"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label floating text-capitalize>{{'Products'|translate}}</ion-label>
          <ion-input type="text" (keyup)="onFarmChange($event)"
                     [(ngModel)]="user.profiles.farmDetails.products"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label floating text-capitalize>{{'Name of the crops'|translate}}</ion-label>
          <ion-input type="text" (keyup)="onFarmChange($event)"
                     [(ngModel)]="user.profiles.farmDetails.crops"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label floating text-capitalize>{{'Grade'|translate}}</ion-label>
          <ion-input type="text" (keyup)="onFarmChange($event)"
                     [(ngModel)]="user.profiles.farmDetails.grade"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label floating text-capitalize>{{'Size'|translate}}</ion-label>
          <ion-input type="text" (keyup)="onFarmChange($event)" [(ngModel)]="user.profiles.farmDetails.size"
                     type="text"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label floating text-capitalize>{{'Region'|translate}}</ion-label>
          <ion-input type="text" (keyup)="onFarmChange($event)" [(ngModel)]="user.profiles.farmDetails.region"
                     type="text"></ion-input>
        </ion-item>
      </ion-list>

      <ion-row>
        <ion-col>
          <!-- [disabled]="disabledButton" -->
          <button (click)="updateFarm()" [disabled]="disabledFarmButton" ion-button block class="btnHeight40Px">
            {{'Save'|translate}}
          </button>
        </ion-col>
      </ion-row>

    </ion-list>

    <ion-list *ngSwitchCase="'documents'">

      <ion-row>
        <ion-col>
          <ion-list-header>
            <div text-center>
              <button ion-button clear style="color: #519a48; letter-spacing: 2px; font-size: 16px"
                      (click)="presentActionSheetDocs()">
                +&nbsp; {{'Add Documents/Images'}}
              </button>
            </div>
          </ion-list-header>
          <div text-center *ngIf="!user.profiles.documents || (user.profiles.documents && !user.profiles.documents.length)">
            <h4 style="opacity: 0.6">No Documents/Images uploaded</h4>
          </div>
          <ion-grid>
            <ion-row align-items-center justify-content-center>
              <ion-col col-auto align-self-center *ngFor="let document of user.profiles.documents">
                <div class="image">
                  <img width="150" height="150" [src]="serverUrl+document.url" imageViewer/>
                  <span *ngIf="document.date">{{document.date|moment:true}} ago</span>
                </div>
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-col>
      </ion-row>

    </ion-list>

  </div>

</ion-content>

